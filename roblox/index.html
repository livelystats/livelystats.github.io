<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Roblox Streamer Stats</title>
  <style>
    :root {
      --accent-color: #ff4b2b;
    }

    body {
      background: linear-gradient(to bottom right, #1f1c2c, #928dab);
      color: white;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 2em;
      transition: all 0.3s ease;
    }

    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 10px;
      border-radius: 8px;
      border: none;
    }

    .color-inputs {
      margin-top: 30px;
    }

    img {
      border-radius: 50%;
      margin-top: 20px;
      border: 4px solid white;
      width: 120px;
      height: 120px;
    }

    #stats p {
      font-size: 1.2em;
      color: var(--accent-color);
      margin: 6px 0;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ® Roblox Stats Viewer</h1>

  <input id="username" type="text" placeholder="Enter Roblox username" />
  <button onclick="startFetching()">Show Stats</button>

  <div class="color-inputs">
    <p>ðŸŽ¨ Customize Your Theme:</p>
    Background: <input type="color" id="bgColor" />
    Text: <input type="color" id="textColor" />
    Accent: <input type="color" id="accentColor" />
    <button onclick="applyTheme()">Apply Theme</button>
  </div>

  <div id="stats"></div>

  <script>
    let intervalId = null;

    async function fetchStats(username) {
      try {
        // Get user ID
        const userRes = await fetch(`https://api.roblox.com/users/get-by-username?username=${username}`);
        const userData = await userRes.json();

        if (!userData || userData.success === false || userData.errorMessage) {
          document.getElementById('stats').innerHTML = `<p style="color:red;">User not found</p>`;
          return;
        }

        const userId = userData.Id;

        // Get avatar thumbnail
        const thumbRes = await fetch(`https://thumbnails.roblox.com/v1/users/avatar?userIds=${userId}&size=150x150&format=Png&isCircular=true`);
        const thumbData = await thumbRes.json();
        const avatarUrl = thumbData.data[0]?.imageUrl || '';

        // Get followers, following, and friends counts
        const [followersRes, followingRes, friendsRes] = await Promise.all([
          fetch(`https://friends.roblox.com/v1/users/${userId}/followers/count`),
          fetch(`https://friends.roblox.com/v1/users/${userId}/followings/count`),
          fetch(`https://friends.roblox.com/v1/users/${userId}/friends/count`)
        ]);

        const followers = (await followersRes.json())?.count || 0;
        const following = (await followingRes.json())?.count || 0;
        const friends = (await friendsRes.json())?.count || 0;

        document.getElementById('stats').innerHTML = `
          <h2>@${userData.Username}</h2>
          <img src="${avatarUrl}" alt="Avatar" />
          <p>Followers: ${followers}</p>
          <p>Following: ${following}</p>
          <p>Friends: ${friends}</p>
        `;
      } catch (error) {
        console.error('Error fetching data:', error);
        document.getElementById('stats').innerHTML = `<p style="color:red;">An error occurred while fetching data.</p>`;
      }
    }

    function startFetching() {
      const username = document.getElementById('username').value.trim();
      if (!username) return;

      clearInterval(intervalId);
      fetchStats(username);
      intervalId = setInterval(() => {
        fetchStats(username);
      }, 5000);
    }

    function applyTheme() {
      const bg = document.getElementById('bgColor').value;
      const text = document.getElementById('textColor').value;
      const accent = document.getElementById('accentColor').value;

      document.body.style.background = bg;
      document.body.style.color = text;
      document.documentElement.style.setProperty('--accent-color', accent);
    }
  </script>
</body>
</html>
